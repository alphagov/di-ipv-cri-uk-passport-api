<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" tests="11" skipped="0" failures="0" errors="0" timestamp="2022-12-01T12:17:35" hostname="UK-WXY6WYG4WJ" time="1.227">
  <properties/>
  <testcase name="shouldThrowIfJwtIdHasAlreadyBeenUsed()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.94"/>
  <testcase name="shouldThrowIfMissingClientAssertionAndClientIdParams()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.01"/>
  <testcase name="shouldThrowIfWrongAudience()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.022"/>
  <testcase name="shouldThrowIfClaimsSetHasExpired()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.006"/>
  <testcase name="shouldThrowIfInvalidSignature()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.017"/>
  <testcase name="shouldNotThrowForValidJwtWithDerSignature()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.068"/>
  <testcase name="shouldNotThrowForValidJwt()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.015"/>
  <testcase name="shouldFailWhenCLientJWTContainsExpiryClaimTooFarInFuture()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.033"/>
  <testcase name="shouldThrowIfMissingJwtId()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.04"/>
  <testcase name="shouldThrowIfClaimsSetIssuerAndSubjectAreNotTheSame()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.032"/>
  <testcase name="shouldThrowIfMissingClientAssertionParam()" classname="uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidatorTest" time="0.01"/>
  <system-out><![CDATA[{"timestamp":"2022-12-01T12:17:36.797+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":797902000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"The client auth JWT id (jti) has already been used","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"jti":"test-jti","usedAtDateTime":"2022-12-01T12:17:36.700052Z"}
{"timestamp":"2022-12-01T12:17:36.817+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":817521000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5}
{"timestamp":"2022-12-01T12:17:36.852+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":852686000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5}
{"timestamp":"2022-12-01T12:17:36.875+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":875978000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5}
{"timestamp":"2022-12-01T12:17:36.885+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":885016000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5}
{"timestamp":"2022-12-01T12:17:36.902+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":902975000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5}
{"timestamp":"2022-12-01T12:17:36.969+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":969671000},"thread":"Test worker","level":"INFO","loggerName":"uk.gov.di.ipv.cri.passport.library.helpers.LogHelper","message":"CLIENT_ID_LOG_FIELD attached to logs","endOfBatch":false,"loggerFqcn":"org.apache.logging.log4j.spi.AbstractLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:36.990+0000GMT","instant":{"epochSecond":1669897056,"nanoOfSecond":990310000},"thread":"Test worker","level":"INFO","loggerName":"uk.gov.di.ipv.cri.passport.library.helpers.LogHelper","message":"CLIENT_ID_LOG_FIELD attached to logs","endOfBatch":false,"loggerFqcn":"org.apache.logging.log4j.spi.AbstractLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:37.024+0000GMT","instant":{"epochSecond":1669897057,"nanoOfSecond":24552000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Client JWT expiry date is too far in the future","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:37.024+0000GMT","instant":{"epochSecond":1669897057,"nanoOfSecond":24971000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:37.068+0000GMT","instant":{"epochSecond":1669897057,"nanoOfSecond":68800000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"The client auth JWT id (jti) is missing","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:37.069+0000GMT","instant":{"epochSecond":1669897057,"nanoOfSecond":69433000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:37.101+0000GMT","instant":{"epochSecond":1669897057,"nanoOfSecond":101959000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
{"timestamp":"2022-12-01T12:17:37.113+0000GMT","instant":{"epochSecond":1669897057,"nanoOfSecond":113795000},"thread":"Test worker","level":"ERROR","loggerName":"uk.gov.di.ipv.cri.passport.accesstoken.validation.TokenRequestValidator","message":"Validation of client_assertion jwt failed","endOfBatch":false,"loggerFqcn":"org.apache.logging.slf4j.Log4jLogger","threadId":1,"threadPriority":5,"clientId":"testClientId"}
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
